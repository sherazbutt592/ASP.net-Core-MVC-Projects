@using ETickets.Data.Enum
@model MovieViewModel
@{
    ViewBag.Title = $"{ViewBag.Operation} Movie";
}
<h3 class="text-center">@ViewBag.Operation Movie</h3>
<form asp-action="AddEdit" asp-controller="Movie" method="post" enctype="multipart/form-data">
    <div class="row mx-auto w-75">
        <div class="col-md-12">
            @* preview Image *@
            <div class="mb-3 d-flex justify-content-center">
                <img src="@Url.Content("~/Images/" + @Model.Image)" alt="Preview Image" id="preview" class="rounded-circle fixed-img-height align" />
            </div>
            <div class="mb-3">
                <label class="form-label">@Html.DisplayNameFor(Model => Model.Image)</label>
                <input class="form-control" type="file" accept="image/*" asp-for="File" onchange="previewImage(event)" />
            </div>
        </div>
        <div class="col-md-6">

            @* Name, StartDate, EndDate, Price *@   
        <div class="mb-3">
                <label class="form-label">@Html.DisplayNameFor(Model => Model.Name)</label>
                <input class="form-control" type="text" asp-for="Name" />
                <span asp-validation-for="Name" class="text-danger"></span>
            </div>
            <div class="mb-3">
                <label class="form-label">@Html.DisplayNameFor(Model => Model.StartDate)</label>
                <input class="form-control" type="date" asp-for="StartDate" />
                <span asp-validation-for="StartDate" class="text-danger"></span>
            </div>
            <div class="mb-3">
                <label class="form-label">@Html.DisplayNameFor(Model => Model.EndDate)</label>
                <input class="form-control" type="date" asp-for="EndDate" />
                <span asp-validation-for="EndDate" class="text-danger"></span>
            </div>
            <div class="mb-3">
                <label class="form-label">@Html.DisplayNameFor(Model => Model.Price)</label>
                <input class="form-control" type="number" step="0.01" asp-for="Price" />
                <span asp-validation-for="Price" class="text-danger"></span>
            </div>
        </div>
        <div class="col-md-6">

            @* Cinema *@
            <div class="mb-3">
                <label class="form-label">Select Cinema</label>
                <select asp-for="CinemaId" class="form-control form-select">
                    @foreach (var item in ViewBag.Cinemas)
                    {
                        if (item.Id == Model.CinemaId)
                        {
                            <option value="@item.Id" selected>@item.Name</option>
                        }
                        else
                        {
                            <option value="@item.Id">@item.Name</option>
                        }
                    }
                </select>
                <span asp-validation-for="CinemaId" class="text-danger"></span>
            </div>

            @* MovieCategory *@
            <div class="mb-3">
                <label class="form-label">Select Category</label>
                <select asp-for="MovieCategory" asp-items="Html.GetEnumSelectList<MovieCategory>()"
                        class="form-control form-select"></select>
                <span asp-validation-for="MovieCategory" class="text-danger"></span>
            </div>

            @* Producer *@
            <div class="mb-3">
                <label class="form-label">Select Producer</label>
                <select asp-for="ProducerId" class="form-select form-control">
                    @foreach (var item in ViewBag.Producers)
                    {
                        if (Model.ProducerId == item.Id)
                        {
                            <option value="@item.Id" selected>@item.FullName</option>
                        }
                        else
                        {
                            <option value="@item.Id">@item.FullName</option>
                        }
                    }
                </select>
                <span asp-validation-for="ProducerId" class="text-danger"></span>
            </div>

            @* Actors *@
            <div class="mb-3">
                <label class="form-label">Select Actors</label>
                <select multiple size="4" class="form-control form-select" asp-for="ActorIds">
                    @foreach (var item in ViewBag.Actors)
                    {
                        if (Model.ActorIds.Contains(item.Id))
                        {
                            <option value="@item.Id" selected>@item.FullName</option>
                        }
                        else
                        {
                            <option value="@item.Id">@item.FullName</option>
                        }

                    }
                </select>
                <span asp-validation-for="ActorIds" class="text-danger"></span>
            </div>
        </div>

        @* Description *@
        <div class="col-md-12">
            <div class="mb-3"></div>
            <label class="form-label">@Html.DisplayNameFor(Model => Model.Description)</label>
            <textarea class="form-control" asp-for="Description" rows="5"></textarea>
            <span asp-validation-for="Description" class="text-danger"></span>
        </div>
        <div class="col-md-12">
            <div class="mt-3 d-flex justify-content-between">
                <input type="submit" value="Save" class="btn btn-outline-dark" />
                <a class="btn btn-outline-dark" asp-action="Index">Show All</a>
            </div>
        </div>
    </div>
</form>
@section Scripts {
    <script>
                function previewImage(event) {
            var reader = new FileReader(); // built-in browser API to read files
            reader.onload = function () {
                var preview = document.getElementById('preview');
                preview.src = reader.result;   // data URL of the image
                preview.classList.remove("d-none");
            }
            reader.readAsDataURL(event.target.files[0]); // read the first selected file
        }

    </script>
}